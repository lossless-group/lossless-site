---
import { loadGalleryConfig, resolveProjectUrl } from '../../utils/projectGalleryUtils';

export const prerender = true;

export async function getStaticPaths() {
  const paths: Array<{ params: { project: string }; props: any }> = [];
  const galleryConfig = loadGalleryConfig();
  
  // Generate paths for each project in the gallery config
  Object.entries(galleryConfig.projects).forEach(([projectId, project]) => {
    const resolvedUrl = resolveProjectUrl(project);
    
    // Add paths for all projects - they will redirect to their specific URL or development page
    paths.push({
      params: { project: projectId },
      props: {
        redirectUrl: resolvedUrl,
        projectTitle: project.title
      }
    });
  });
  
  return paths;
}

const { redirectUrl, projectTitle } = Astro.props;

// Perform server-side redirect
return Astro.redirect(redirectUrl);
---
