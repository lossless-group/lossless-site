---
import "@styles/global.css";
import Hero from "@components/basics/Hero.astro";
import CardGrid from "@basics/CardGrid.astro";
import { getEntry, getCollection } from "astro:content";
import Section__ToolsTracking from "@components/basics/messages/Section__ToolsTracking.astro";
import ThinGradientBleedSeparator from "@basics/separators/ThinGradientBleedSeparator.astro";
import AlternatingSideImageComponent from "@components/basics/messages/AlternatingSideImage.astro";
import Section__IconHeaderMessage from "@components/basics/messages/Section__IconHeaderMessage.astro";
import Section__QuestionsAnswers from "./reference/Section__QuestionsAnswers.astro";
import questionsAndAnswersData from "../content/q-and-a/questionsAndAnswers.json";
import Section__VibeCodeWithUs from "@components/basics/messages/Section__VibeCodeWithUs.astro";
import ClientListHorizontalScrollerStealth from "@components/basics/messages/ClientListHorizontalScroller--stealth.astro";
import clientsData from "../content/people/clients.json";
import { loadToolsFromMoc } from "@utils/toolUtils";


interface Tool {
  url: string;
  site_name?: string;
  title?: string;
  image?: string;
  favicon?: string;
  description?: string;
  tags?: string[];
  id: string;
}

// Load tools from Home.md MOC file
const mocEntries = await getCollection("moc");
const homeMocEntry = mocEntries.find(entry => entry.id === "home");
const toolEntries = await getCollection("tooling");
const tools = homeMocEntry ? await loadToolsFromMoc(homeMocEntry, toolEntries) : [];

// Extract the questionsAndAnswers array for the "main" page
const qaList = questionsAndAnswersData.page === "main"
  ? questionsAndAnswersData.questionsAndAnswers
  : [];

// Load clients data for stealth section
const clients = clientsData.clients;

---

<!-- Full-bleed separator with subtle styling -->
<ThinGradientBleedSeparator 
  height="1px" 
  marginTop="0.5rem" 
  marginBottom="1rem" 
  color="var(--grd__primary-bg)" 
/>

<Section__VibeCodeWithUs />

<!-- Tools Tracking Section -->
<div class="content-wrapper">
  <Section__ToolsTracking />
</div>

<!-- Full-bleed separator with subtle styling -->
<ThinGradientBleedSeparator 
  height="1px" 
  marginTop="0.5rem" 
  marginBottom="1rem" 
  color="var(--grd__primary-bg)" 
/>

<!-- Full-bleed Stealth Clients Section -->
<div class="stealth-clients-fullbleed">
  <div class="stealth-clients-content">
    <ClientListHorizontalScrollerStealth clients={clients} />
  </div>
</div>

<!-- Section: IconHeaderMessage grid for homepage (index instance) -->
<section class="content-wrapper content-wrapper--tight-top">
  <Section__IconHeaderMessage instance="index" />
</section>

<!-- Content section with alternating side images -->
<div class="content-wrapper">
  <section>
    <AlternatingSideImageComponent jsonPath="messages/featureSideImage.json" />
  </section>
</div>

<!-- Full-bleed separator with standard styling -->
<ThinGradientBleedSeparator 
  height="2px" 
  marginTop="1rem" 
  marginBottom="1rem" 
  color="var(--grd__primary-bg)" 
/>

<!-- Q&A Section (Accordion) -->
<div class="content-wrapper">
  <section>
    <h2>Frequently Asked Questions</h2>
    <Section__QuestionsAnswers qaList={qaList} containerClass="w-[80vw]" />
  </section>
</div>


<!-- Full-bleed separator with more prominent styling -->
<ThinGradientBleedSeparator 
  height="3px" 
  marginTop="1.5rem" 
  marginBottom="1.5rem" 
  color="var(--grd__primary-bg)" 
  animate={true}
/>

<section class="example-section" data-animate="fade-up" data-animate-delay="0.2">
  <Hero
    title="Harness the Power of AI with the right toolkit."
    subtitle="Curated AI Tooling"
    description="We've vetted over 300 AI tools to find the best options. We can customize recommendations based on your needs."
    ctaText="Check it out!"
    ctaUrl="/ai-toolkit"
    alignment="center"
    fullBleed={false}
    animate={true}
  />
</section>

<!-- Content section with card grid -->
<div class="content-wrapper">
  <section>
    {
      tools && tools.length > 0 ? (
        <CardGrid gap="2rem" tools={tools} />
      ) : (
        <p>No tools found</p>
      )
    }
  </section>
</div>

<style>
  h1,
  h2 {
    margin-top: 1rem;
  }

  /* Content wrapper with consistent 92% max-width */
  .content-wrapper {
    width: 92%;
    max-width: 92%;
    margin: 0 auto;
    padding: 2rem 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }
  
  /* Tight spacing variant for sections that need less top padding */
  .content-wrapper--tight-top {
    padding-top: 0;
  }


  #hero-container {
    display: flex;
    background: var(--grd--lossless-eastern-crimson);
    padding: 2rem;
    border-radius: 1rem;
    width: 100%;
    justify-content: center;
    align-items: center;
  }

  section {
    width: 100%;
    margin: 0 auto;
    padding: 1rem 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }


  /* Full-bleed container for stealth clients */
  .stealth-clients-fullbleed {
    width: 100vw;
    max-width: 100vw;
    position: relative;
    left: 50%;
    transform: translateX(-50%);
    overflow: hidden;
    padding: 4rem 0 0.5rem 0;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  
  .stealth-clients-content {
    width: 92%;
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    justify-content: center;
    overflow: hidden;
  }

  /* Mobile adjustments for full-bleed sections */
  @media (max-width: 768px) {
    .stealth-clients-fullbleed {
      max-width: 100vw;
      overflow: hidden;
      padding: 2rem 0 0.5rem 0;
    }
    
    .stealth-clients-content {
      width: 100%;
      max-width: 100vw;
      overflow: hidden;
      padding: 0;
    }
  }
  
  /* Extra small mobile adjustments */
  @media (max-width: 480px) {
    .stealth-clients-fullbleed {
      padding: 1.5rem 0 0.5rem 0;
    }
  }
</style>
