---
/**
 * Changelog Layout
 * 
 * Displays a list of changelog entries in chronological order.
 * Shows both code and content changes in a two-column layout.
 * 
 * @component
 */

interface Props {
  title: string;
  description: string;
}

const { title, description } = Astro.props;

import { getCollection } from "astro:content";
import path from 'path';
import ArticleListColumn from '@components/articles/ArticleListColumn.astro';
import ChangelogEntry from '@components/changelog/ChangelogEntry.astro';
import Layout from "@layouts/Layout.astro";

// Get content changes
const contentChanges = await getCollection('changelog--content');

// Sort changes by date in descending order
const sortByDate = (a, b) => {
  const dateA = new Date(a.data.date);
  const dateB = new Date(b.data.date);
  return dateB.getTime() - dateA.getTime();
};

const sortedContentChanges = contentChanges.sort(sortByDate);

---
<Layout title={title} description={description}>
  <main>
    <div class="changelog-container">
      <ArticleListColumn
        entries={sortedContentChanges.map(entry => ({
          ...entry.data,
          slug: path.basename(entry.id, '.md')
        }))}
        EntryComponent={ChangelogEntry}
      />
    </div>
  </main>
</Layout>

<style>
  .changelog-container {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    padding: 1rem;
  }
</style>